<!DOCTYPE html>
<html>
    <head>

        <script>

            var datainfoshown = false;

            function initcookies() {

                if(localStorage.getItem("gefaengnishefte_cookies") == "true"){
                    showcookiecontent();
                }
                else {
                    hidecookiecontent();
                }
            }

            function cookies(choice) {
                document.getElementById("databanner").style.display = "none";

                if(choice) {
                    localStorage.setItem("gefaengnishefte_cookies", choice);
                }

                initcookies();
            }

            // window.addEventListener("beforeunload", function(e){
            //     alert("start!")
            //     clearcookies()
            // });

            // window.onbeforeunload = function(event) {
            //     alert("start!")
            //     clearcookies()
            // };

            function clearcookies() {
                sessionStorage.clear();
                localStorage.clear();

                var cookies = document.cookie.split(";");

                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i];
                    var eqPos = cookie.indexOf("=");
                    var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
                }
                // alert("done!")
            }

            function showcookiecontent() {
                var frames = document.getElementsByTagName("iframe")

                for (let i = 0; i < frames.length; i++)
                {

                    let frameURL = frames[i].innerHTML

                    frames[i].removeAttribute("sandbox")
                    frames[i].innerHTML = ""
                    frames[i].src = frameURL
                    frames[i].style.display = "block"
                }

                var cookiedisclaimers = document.getElementsByClassName("cookiedisclaimer")

                for (let i = 0; i < cookiedisclaimers.length; i)
                {
                    cookiedisclaimers[i].remove();
                }

                datainfoshown = false;
            }

            function hidecookiecontent() {
                var frames = document.getElementsByTagName("iframe")
                if(!datainfoshown) {
                    
                    for (let i = 0; i < frames.length; i++)
                    {
                        var cookiedisclaimer = document.createElement("span");
                        cookiedisclaimer.innerHTML = "Dieser Inhalt erfordert die <span style='text-decoration: underline; cursor: pointer;' onclick='showdatabanner()'>Zustimmung zu Cookies</span>.";
                        cookiedisclaimer.className = "cookiedisclaimer";
                        
                        frames[i].style.display = "none"
                        frames[i].parentNode.insertBefore(cookiedisclaimer, frames[i])
                    }

                    datainfoshown = true;
                }
            }

            function showdatabanner() {
                document.getElementById("databanner").style.display = "block";
            }

        </script>

        <style>

            #databanner {
                display:none;
            }

            #datenschutz {
                background-color: var(--header-color);
                color: white;
                font-size: 13pt;
                position: absolute;
                left: 0;
                bottom: 0;
                width:100%;
                z-index: 20;
            }

            #datainfo {
                width: 600px;
                margin-bottom: 40px;
            }

            #dataoptionen {
                display:flex;
                flex-flow: row wrap;
                align-items: center;
                gap:20px;
            }

            .dataoption {
                width:140px;
                cursor: pointer;
                font-size: 13pt;
                background-color: transparent;
                color:white;
            }

            #datenschutz-inner {
                padding:20px;
            }

            @media screen and (max-width: 450px) {#dataoptionen { justify-content: space-around;}}


        </style>
    </head>

    <body>

        <div id="datenschutz">
            <div id="datenschutz-inner">
                <div id="datainfo">
                    Diese Internetseite verwendet Cookies, um das vollständige Anzeigen aller Inhalte zu ermöglichen. Durch das klicken des Akzeptieren-Buttons, stimmst du deren Verwendung zu. Weitere Informationen hierzu findest du in unserer <a style="text-decoration: underline;" href="https://www.GEFAENGNISHEFTE.org/datenschutz" target="_blank">Datenschutzerklärung</a>.
                </div>
                <div id="dataoptionen">
                    <button class="dataoption" onclick="cookies(true)">Akzeptieren</button>
                    <button class="dataoption" onclick="cookies(false)">Ablehnen</button>
                </div>
            </div>
        </div>
    </body>
</html>