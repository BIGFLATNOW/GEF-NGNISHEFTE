<!DOCTYPE html>
<html>
    <head>

        <script>

            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////// INIT /////////////////////////////////////////////////////
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////


            var slideList = []

            function initcontrols() {
                
                slidesList = document.getElementById("slides").children
                for (let i = 0; i < slidesList.length; i++) {
                    let slideID = 'slide'+ (i+1)
                    slidesList.item(i).setAttribute('id', slideID);
                    slideList.push(slideID);
                }

                for (let i = 0; i < slideList.length; i++) {
                    if(useindexlist) {
                        $('#slideIndex').append('<span id="index' + i + '" class="indexitem" onclick="displayBySlideIndex(' + i + ')">' + indexList[i] + '</span><br>');
                    }
                    else {
                        let titleDE = document.getElementById(slideList[i]).getAttribute('data-title-de')
                        let titleEN = document.getElementById(slideList[i]).getAttribute('data-title-en')
                        
                        $('#slideIndex').append('<span id="index' + i + '" class="indexitem" onclick="displayBySlideIndex(' + i + ')">' + "<span lang='de'>" + titleDE + "</span><span lang='en'>" + titleEN + "</span>" + '</span><br>');
                    }
                    
                }
                
                resetcontrols()
                displaycurrent()
                keeptop()

                controlsinit = true
            }



            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            //////////////////////////////////////////////// SLIDE SELECTION ////////////////////////////////////////////////
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////

            // SLIDE SELECTION

            function displaycurrent() {
                if(showcurrenttitle) {
                    document.getElementById("slideCurrentTitle").innerHTML = titleList[slideSelected]
                }
                if(overridetitle) {
                    document.getElementById("slideCurrent").innerHTML = overridetitletext
                }
                else {
                    document.getElementById("slideCurrent").innerHTML = (slideSelected + 1) + "/" + slideList.length
                }

                if(showcurrenttitle||overridetitle) {
                    initlanguage() //needed bc it changes DOM
                }
            }

            function loadframes() {
                loadframe(document.getElementById(slideList[slideSelected]).getElementsByTagName("iframe"), 0)
            }


            function letztesissue() {
                if(slideSelected>=0) {
                    document.getElementById(slideList[slideSelected]).style.display = "none";
                    slideSelected = slideSelected - 1;
                    document.getElementById(slideList[slideSelected]).style.display = "flex";
                }

                loadframes()
                resetcontrols();
                displaycurrent();
                keeptop();
                timecontrols();
                pausevideos();
            }

            function nächstesissue() {
                if(slideSelected<=slideList.length-1) {
                    document.getElementById(slideList[slideSelected]).style.display = "none";
                    slideSelected = slideSelected + 1;
                    document.getElementById(slideList[slideSelected]).style.display = "flex";
                }

                loadframes()
                resetcontrols();
                displaycurrent();
                keeptop();
                timecontrols();
                pausevideos();
            }

            function displayBySlideIndex(slideIndex) {
                document.getElementById(slideList[slideSelected]).style.display = "none";
                slideSelected = slideIndex;
                document.getElementById(slideList[slideSelected]).style.display = "flex";

                loadframes()
                resetcontrols();
                displaycurrent();
                hideSlideIndex();
                keeptop();
                pausevideos();
            }


            // SLIDE INDEX

            function displaySlideIndex() {
                var indexitems = document.getElementsByClassName("indexitem")
                for (let i = 0; i < indexitems.length; i++) {
                    indexitems[i].style.fontWeight = "300"
                }

                document.getElementById("index"+slideSelected).style.fontWeight = "700"
                document.getElementById("slideCurrentTitle").style.display = "none";
                document.getElementById(slideList[slideSelected]).style.display = "none";
                document.getElementById("slideIndex").style.display = "block";
            }

            function hideSlideIndex() {
                document.getElementById("slideCurrentTitle").style.display = "block";
                document.getElementById("slideIndex").style.display = "none";
                document.getElementById(slideList[slideSelected]).style.display = "flex";
            }



            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            ///////////////////////////////////////////////// VISUAL TWEAKS /////////////////////////////////////////////////
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////


            var timeoutIDindex;
            var timeoutIDcontrols;
            var oncontrols = false;


            // SCROLLBAR

            function hidescrollbarindex() {
                document.documentElement.style.setProperty('--scrollbar-color-index', 'transparent');
            }

            document.getElementById("slideIndex").addEventListener("scroll", () => {
                document.documentElement.style.setProperty('--scrollbar-color-index', getComputedStyle(document.documentElement).getPropertyValue('--default-scrollbar-color-index'));
                clearTimeout(timeoutIDindex)
                timeoutIDindex = setTimeout(hidescrollbarindex, 10000);
            });

            function keeptop() {
                document.getElementById("content").scrollTop = 0;
                document.documentElement.scrollTop = 0;
                if(typeof hidescrollbar === "function"){
                    setTimeout(hidescrollbar, 1);
                }
            }


            // CONTROL AUTO HIDING

            document.getElementById("controls").addEventListener("mousemove", initautohidecontrols);

            function initautohidecontrols() {
                document.addEventListener("mousemove", timecontrols);
                document.getElementById("controls").removeEventListener("mousemove", initautohidecontrols);
            }

            function hidecontrols() {
                document.getElementById("controls-inner").style.visibility = "hidden";
            }

            // timer start

            function timecontrols() {
                if(autohidecontrols == true && oncontrols == false) {
                    document.getElementById("controls-inner").style.visibility = "visible";
                    clearTimeout(timeoutIDcontrols)
                    timeoutIDcontrols = setTimeout(hidecontrols, 8000);
                }
            }

            function entercontrols() {
                clearTimeout(timeoutIDcontrols)
                oncontrols = true;
            }

            function leavecontrols() {
                timecontrols();
                oncontrols = false;
            }

            document.getElementById("slideIndex").addEventListener("mouseenter", entercontrols)
            document.getElementById("letztes").addEventListener("mouseenter", entercontrols)
            document.getElementById("slideCurrent").addEventListener("mouseenter", entercontrols)
            document.getElementById("nächstes").addEventListener("mouseenter", entercontrols)

            document.getElementById("slideIndex").addEventListener("mouseleave", leavecontrols)
            document.getElementById("letztes").addEventListener("mouseleave", leavecontrols)
            document.getElementById("slideCurrent").addEventListener("mouseleave", leavecontrols)
            document.getElementById("nächstes").addEventListener("mouseleave", leavecontrols)


            // CONTROL DISABLEING

            function resetcontrols() {
                if (slideSelected==0) {
                    document.getElementById("letztes").disabled = true;
                    document.getElementById("letztes").style.color = "lightgrey";
                }
                else {
                    document.getElementById("letztes").disabled = false;
                    document.getElementById("letztes").style.color = "white";
                }
                
                if (slideSelected==slideList.length-1) {
                    document.getElementById("nächstes").disabled = true;
                    document.getElementById("nächstes").style.color = "lightgrey";
                }
                else {
                    document.getElementById("nächstes").disabled = false;
                    document.getElementById("nächstes").style.color = "white";
                }
            }


        </script>


        <style>

            /* SLIDES */

            #content {
                display: grid;
                grid-template-columns: 1fr auto 1fr;
                grid-template-rows: 1fr auto 1fr;
                grid-template-areas: 
                    ". . ."
                    ". slides ."
                    ". . .";
                place-items:center;
                height: calc(var(--vh, 1vh) * 100 - 245px);
            }



            #slides {
                grid-area: slides;
            }

            #slides > div {
                display: none;
                flex-wrap:wrap;
                place-content: center;
                text-align: center;
                gap:40px 80px;
                margin-bottom: 40px;
            }


            /* CONTROLS */

            #controls {
                position: absolute;
                bottom:0;
                display:flex;
                align-items: center;
                justify-content: center;
                flex-direction: column;
                width:100vw;
                padding-bottom: 60px;
            }

            #controlsWrap {
                display:flex;
                place-items: center;
                flex-direction: column;
            }

            #controls-inner {
                text-align: center;
                display: flex;
                flex-wrap:wrap;
                justify-content: center;
                align-items: center;
                gap:20px 70px;
                width:100%;
                bottom:0;
                left:0;
            }

            #letztes, #nächstes, #slideCurrent {
                background-color: transparent;
                color:white;
                width: 45px;
                height: 45px;
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }

            #letztes, #nächstes {
                padding: 5px 15px 5px 15px;
                width:175px;
                font-size: 15pt;
                cursor: pointer;
            }

            #slideCurrent {
                width:80px;
                font-size: 20pt;
                cursor: default;
            }

            #slideIndex {
                max-height:70vh;
                overflow:auto;
                color:white;
                text-align: center;
                font-size: 20pt;
                display:none;
                width:fit-content;
                padding: 40px 20px 40px 20px;
                scrollbar-gutter: stable both-edges;
            }

            #slideIndex>span:hover {
                color:var(--content-color-link-hover);
                cursor: pointer;
            }

            /* SCROLLBAR */

            :root {
                --scrollbar-color-index: transparent;
                --default-scrollbar-color-index: white;
            }

            #slideIndex::-webkit-scrollbar-thumb {
                background: var(--scrollbar-color-index) !important;
            }

            #slideIndex {
                scrollbar-color: var(--scrollbar-color-index) transparent !important;
            }


            /* SIZING */

            @media screen and (max-width: 800px) {
                #controls-inner {
                    gap:20px;
                }
            }

            .controlLabelSmall {
                position:relative;
                bottom:17px;
                display: none;
            }

            @media screen and (max-width: 520px) {
                .controlLabelLarge {
                    display: none;
                }

                .controlLabelSmall {
                    display: inline;
                }

                #letztes, #nächstes {
                    padding:0px;
                    width: 45px;
                    font-size: 35pt;
                }
            }

            #slideCurrentTitle {
                font-size: 15pt;
                padding: 20px;
                color:white;
                text-align:center;
            }

            @media screen and (max-height: 800px) {

                #content {
                    height: calc(var(--vh, 1vh) * 100 - 215px);
                }

                #controls {
                    padding-bottom:30px;
                }
            }

            @media screen and (max-height: 550px) {

                #content {
                    height: calc(var(--vh, 1vh) * 100 - 195px);
                }

                #slideCurrentTitle {
                    padding-top:10px;
                    padding-bottom:10px;
                }
            }

        </style>
    </head>

    <body>

        <div id="controlsWrap">
            <div id="slideCurrentTitle"></div>


            <div id="slideIndex-wrap">
                <div id="slideIndex" onmouseenter="displaySlideIndex()" onmouseleave="hideSlideIndex()"></div>
            </div>

            <div id="controls-inner">
                <button id="letztes" onclick="letztesissue()">
                    <span class="controlLabelLarge"><span lang="de">VORHERIGES</span><span lang="en">PREVIOUS</span></span><span class="controlLabelSmall">‹</span>
                </button>
                <button id="slideCurrent" onmouseenter="displaySlideIndex()" onmouseleave="hideSlideIndex()">
                </button>
                <button id="nächstes" onclick="nächstesissue()">
                    <span class="controlLabelLarge"><span lang="de">NÄCHSTES</span><span lang="en">NEXT</span></span><span class="controlLabelSmall">›</span>
                </button>
            </div>
        </div>

    </body>
</html>