<!DOCTYPE html>
<html>
    <head>

        <script>
            // INIT

            function initfooter() {
                // document.getElementById('download-issue').setAttribute('href', downloadlocation);
                document.getElementById('download-issue-footer').setAttribute('href', downloadlocation);
                resetverticalbuttons()
                initfootnotes()
            }
        </script>

        <script>

            // FOOTNOTES

            // ⁰¹²³⁴⁵⁶⁷⁸⁹⁽⁾
            var superscriptList = [
                '⁰',
                '¹',
                '²',
                '³',
                '⁴',
                '⁵',
                '⁶',
                '⁷',
                '⁸',
                '⁹'
            ]

            function tosuperscript(num) {
                num = num.toString()
                nums = num.split('')

                for (let i = 0; i < nums.length; i++){
                    nums[i] = superscriptList[nums[i]]
                }

                return nums.join()
            }

            function initfootnotes() {
                for (let i = 1; i < footnoteList.length + 1; i++) {
                    let number = tosuperscript(i)

                    let footnote = document.getElementById("f"+i)
                    footnote.className = 'footnote';
                    footnote.tabIndex = '0'
                    footnote.innerHTML = number;
                    footnote.addEventListener("mouseenter", selectfootnote)

                    let note = document.createElement('span');
                    note.className = 'note';
                    note.innerHTML = number + " " + footnoteList[(i-1)];

                    footnote.appendChild(note)
                }
            }

            document.addEventListener("click", focusfootnote)
            var footnotefocused = "none";

            function focusfootnote(event) {
                if(event.target.className == "footnote") {
                    selectfootnote(event)
                }
                else if(!footnotefocused.contains(event.target)) {
                    resetfootnote()
                    pausevideos();
                }
            }

            function selectfootnote(event) {

                if(footnotefocused != "none") {
                    resetfootnote()
                }

                footnotefocused = event.target;

                footnotefocused.style.color = "#980000";
                footnotefocused.childNodes[1].style.display = "inline";
            }

            function resetfootnote() {
                footnotefocused.style.color = "black";
                footnotefocused.childNodes[1].style.display = "none";
                footnotefocused = "none";
            }

        </script>

        <script>

            // VERTICAL NAVIGATION

            var layoutList = ["info-wrapper", "posthistorische-klassenkaempfe", "der-neue-rahmen", "agieren-und-agitieren"]
            var layoutCurrent = 0

            function resetverticalbuttons() {
                if (layoutCurrent==0) {
                    document.getElementById("to-top").disabled = true;
                    document.getElementById("to-top").style.color = "lightgrey";
                }
                else {
                    document.getElementById("to-top").disabled = false;
                    document.getElementById("to-top").style.color = "white";
                }
                
                if (layoutCurrent==layoutList.length-1) {
                    document.getElementById("to-bottom").disabled = true;
                    document.getElementById("to-bottom").style.color = "lightgrey";
                }
                else {
                    document.getElementById("to-bottom").disabled = false;
                    document.getElementById("to-bottom").style.color = "white";
                }
            }

            function verticalup() {
                // var lastlay = layoutCurrent

                if(layoutCurrent > 0) {
                    layoutCurrent = layoutCurrent - 1
                    document.getElementById(layoutList[layoutCurrent]).scrollIntoView()
                    resetverticalbuttons()
                    // console.log("UP from " + lastlay + " to " + layoutCurrent)
                }
            }

            function verticaldown() {
                // var lastlay = layoutCurrent

                if(layoutCurrent < layoutList.length - 1) {
                    layoutCurrent = layoutCurrent + 1
                    document.getElementById(layoutList[layoutCurrent]).scrollIntoView()
                    resetverticalbuttons()
                    // console.log("DOWN from " + lastlay + " to " + layoutCurrent)
                }
            }
            

            document.getElementById("content").addEventListener("scroll", function() {
                
                var scrollheight = document.getElementById("content").scrollTop
                layoutCurrent = 0;
                // var contentheight = window.innerHeight
                // var lasti, last, offsetlast
                // var istop = true;
                for (let i = 0; i < layoutList.length; i++) {
                    // offsetlast = document.getElementById(layoutList[0]).offsetTop
                    if(scrollheight >=document.getElementById(layoutList[i]).offsetTop - 150){
                        layoutCurrent = i;
                        // offsetlast = document.getElementById(layoutList[i]).offsetTop
                        // last = layoutList[i]
                        // lasti = i
                        // istop = false;
                    }
                }

                resetverticalbuttons()

                // if(istop) {
                //     layoutCurrent = 0;
                //     offsetlast = document.getElementById(layoutList[0]).offsetTop
                    // last = layoutList[0]
                    // lasti = 0
                // }
                // console.log("SCROLLING: "+ Math.round(scrollheight) +"   \n element:"+last+" ("+offsetlast+" | "+layoutCurrent+")")
            })
        </script>

        <script>

            // COPY LINK

            var textOriginal;
            const textList = [];
            var textIndex = 0;

            function copyanchor(anchor, id, textReplace) {
                navigator.clipboard.writeText('https://www.gefaengnishefte.org/issue-i' + id);
                var text = anchor.innerText
                if (text != textReplace){
                    textOriginal = text;
                    textList.push(textOriginal)
                
                    anchor.innerText = textReplace;
                    setTimeout(function(){
                        anchor.innerText = textList[textIndex];
                        textIndex = textIndex + 1;
                    }, 3000);
                }
            }
        </script>

        <style>

            #footer {
                display: flex;
                justify-content: flex-end;
                align-items: flex-start;
                color:white;
                position: absolute;
                height:fit-content;
                bottom:0;
                left:0;
                width:100%;
                z-index:8;
                background-color: #980000;
            }

            #footercontent {
                display: flex;
                justify-content: flex-end;
                align-items: flex-start;
                color:white;
                gap:30px;
                padding-left: 20px;
                padding-right: 20px;
            }

            .footerElement {
                text-align: center;
            }

            .footerElement:hover {
                color:white !important;
            }

            #teilen {
                cursor: pointer;
            }


            /* RETURN TO TOP */

            #to-top, #to-bottom {
                cursor: pointer;
                font-size:13pt;
                position: fixed;
                bottom:40px;
                right:20px;
                background-color: var(--header-color);
                color: var(--header-color-text);
                padding:0px;
                width: 45px;
                height: 45px;
                font-size: 35pt;
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }

            #to-top {bottom:90px;}
            #to-bottom {bottom:40px;}


            #to-top-label {
                position:relative;
                bottom:16px;
                left:2px;
                transform: rotate(90deg);
                -webkit-transform: rotate(90deg);
                -moz-transform: rotate(90deg);
                -ms-transform: rotate(90deg);
                -o-transform: rotate(90deg);
                -o-transform: rotate(90deg);
            }


            /* REACTIVE */

            .label-s {
                    display: none;
            }

            @media screen and (max-width: 550px) {
                #footercontent {
                    width:100%;
                    justify-content: space-between;
                    justify-content: space-evenly;
                    gap:15px;
                }
            }

            @media screen and (max-width: 300px) {

                #footercontent {
                    gap:0px 20px;
                }

                .label-l {
                    display: none;
                }

                .label-s {
                    display: inline;
                }
            }


        </style>
    </head>

    <body>

        <div id="footer">
            <button id="to-top" onclick="verticalup()"><div id="to-top-label">‹</div></button>
            <button id="to-bottom" onclick="verticaldown()"><div id="to-top-label">›</div></button>
            <div id="footercontent">

                <div class="footerElement" id="teilen" >
                    <small class="footerElement"><span class="label-l" onclick="copyanchor(this, '', 'Link kopiert!')">ISSUE teilen</span><span class="label-s" onclick="copyanchor(this, '', 'Link kopiert!')">Teilen</span></small>
                </div>

                <a class="footerElement" id="download-issue-footer" download><span class="label-l">PDF herunterladen</span><span class="label-s">Herunterladen</span></a>
            </div>
        </div>

    </body>
</html>